#!/usr/bin/python
# Copyright @ 2012 Michael P. Reilly. All rights reserved.

from pyerector import *

Clean.files = ('pyerector.tgz', 'pyerector.zip', 'build', 'dist', 'MANIFEST')
Clean.dependencies = ('Cleantest',)
InitDirs.files = ('testdir/zip', 'testdir/tar')
Packaging.tasks = ('MakeZip_t', 'MakeTar_t')

class MakeZip_t(Zip):
    name = 'pyerector.zip'
    files = ('pyerector.py', 'pyerector.pyc', 'setup.py', 'README', 'LICENSE')
class MakeTar_t(Tar):
    name = 'pyerector.tgz'
    files = ('pyerector.py', 'pyerector.pyc', 'setup.py', 'README', 'LICENSE')
class Untar_t(Untar):
    root = 'testdir/tar'
    name = 'pyerector.tgz'
class Unzip_t(Unzip):
    root = 'testdir/zip'
    name = 'pyerector.zip'
class CleanTest_t(Remove):
    files = ('testdir',)
class Localtest(Target):
    tasks = ('Untar_t', 'Unzip_t')
    dependencies = ('InitDirs', 'Packaging',)
class Cleantest(Target):
    tasks = ('CleanTest_t',)
class Unittest_t(Spawn):
    cmd = ('python', '-munittest', 'pyerector')
class Unittest_T(Target):
    tasks = ('Unittest_t',)
#Unittest.modules = ('pyerector',)
Test.dependencies = ('Localtest',) + Test.dependencies

pymain()
